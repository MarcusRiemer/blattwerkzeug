{
  "$ref": "#/definitions/BlockLanguageDocument",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "definitions": {
    "BlockLanguageDocument": {
      "additionalProperties": false,
      "description": "The data about a language model that is stored in the database",
      "properties": {
        "editorBlocks": {
          "description": "How blocks should be represented in the drag & drop editor.",
          "items": {
            "$ref": "#/definitions/EditorBlockDescription"
          },
          "type": "array"
        },
        "sidebarBlocks": {
          "description": "All blocks that should be shown in the sidebar.",
          "items": {
            "$ref": "#/definitions/SidebarBlockDescription"
          },
          "type": "array"
        }
      },
      "required": [
        "sidebarBlocks",
        "editorBlocks"
      ],
      "type": "object"
    },
    "EditorBlockDescription": {
      "additionalProperties": false,
      "description": "Describes how certain nodes in the syntaxtree should be presented\nto an end user inside the drag & drop interface.",
      "properties": {
        "describedType": {
          "$ref": "#/definitions/QualifiedTypeName",
          "description": "Nodes of this type are presented using this block."
        },
        "visual": {
          "description": "The actual visual representation.",
          "items": {
            "$ref": "#/definitions/VisualBlockDescriptions.ConcreteBlock"
          },
          "type": "array"
        }
      },
      "required": [
        "describedType",
        "visual"
      ],
      "type": "object"
    },
    "NodeDescription": {
      "additionalProperties": false,
      "description": "This description regulates how all ASTs should be stored when\nwritten to disk or sent over the wire. It requires every\nnode to at least tell its name and some hint how a node can be\nconstructed at runtime.\n\nThe data of a node is split up in two broader categories:\nChildren, which may be nested and properties, which should\nnot allow any nesting.",
      "properties": {
        "children": {
          "additionalProperties": {
            "items": {
              "$ref": "#/definitions/NodeDescription"
            },
            "type": "array"
          },
          "description": "Nodes may have children in various categories. This base class\nmakes no assumptions about the names of children. Examples for\nchildren in multiple categories would be things like \"attributes\"\nand generic \"children\" in a specialization for XML.",
          "type": "object"
        },
        "language": {
          "description": "This is effectively a namespace, allowing identical\nnames for nodes in different languages.",
          "type": "string"
        },
        "name": {
          "description": "The name of this not, this is used to lookup the name of a\ncorresponding type.",
          "type": "string"
        },
        "properties": {
          "description": "Nodes may have all kinds of properties that are specific to their\nconcrete use.",
          "type": "object"
        }
      },
      "required": [
        "name",
        "language"
      ],
      "type": "object"
    },
    "QualifiedTypeName": {
      "additionalProperties": false,
      "description": "Used when refererring to types that are defined other languages.",
      "properties": {
        "languageName": {
          "type": "string"
        },
        "typeName": {
          "type": "string"
        }
      },
      "required": [
        "typeName",
        "languageName"
      ],
      "type": "object"
    },
    "SidebarBlockDescription": {
      "additionalProperties": false,
      "description": "Describes how the available types should be represented in the sidebar.\nIt is perfectly fine to have multiple sidebar descriptions for the\nsame underlying type.",
      "properties": {
        "defaultNode": {
          "$ref": "#/definitions/NodeDescription",
          "description": "This description will be instanciated every time an \"empty\" node\nis needed. This happens e.g. when the user starts dragging this\nblock from the sidebar."
        },
        "sidebar": {
          "additionalProperties": false,
          "description": "How this block should be represented in the sidebar.",
          "properties": {
            "category": {
              "type": "string"
            },
            "displayName": {
              "type": "string"
            }
          },
          "required": [
            "category"
          ],
          "type": "object"
        }
      },
      "required": [
        "sidebar",
        "defaultNode"
      ],
      "type": "object"
    },
    "VisualBlockDescriptions.ConcreteBlock": {
      "anyOf": [
        {
          "$ref": "#/definitions/VisualBlockDescriptions.EditorBlock"
        },
        {
          "$ref": "#/definitions/VisualBlockDescriptions.EditorDropTarget"
        },
        {
          "$ref": "#/definitions/VisualBlockDescriptions.EditorIterator"
        },
        {
          "$ref": "#/definitions/VisualBlockDescriptions.EditorConstant"
        },
        {
          "$ref": "#/definitions/VisualBlockDescriptions.EditorInterpolated"
        }
      ]
    },
    "VisualBlockDescriptions.DropTargetProperties": {
      "additionalProperties": false,
      "description": "These properties are required to specify drop targets.",
      "properties": {
        "actionParent": {
          "type": "string"
        },
        "actionSelf": {
          "additionalProperties": false,
          "properties": {
            "order": {
              "enum": [
                "insertBefore",
                "insertAfter"
              ],
              "type": "string"
            },
            "skipParents": {
              "type": "number"
            }
          },
          "required": [
            "order",
            "skipParents"
          ],
          "type": "object"
        }
      },
      "type": "object"
    },
    "VisualBlockDescriptions.EditorBlock": {
      "additionalProperties": false,
      "description": "Describes how a certain block should be represented. Blocks are\nalways draggable and also possible drop targets.",
      "properties": {
        "blockType": {
          "enum": [
            "block"
          ],
          "type": "string"
        },
        "children": {
          "items": {
            "$ref": "#/definitions/VisualBlockDescriptions.ConcreteBlock"
          },
          "type": "array"
        },
        "direction": {
          "enum": [
            "horizontal",
            "vertical"
          ],
          "type": "string"
        },
        "dropAction": {
          "enum": [
            "append",
            "replace"
          ],
          "type": "string"
        },
        "dropTarget": {
          "$ref": "#/definitions/VisualBlockDescriptions.DropTargetProperties"
        },
        "marginLeft": {
          "type": "string"
        }
      },
      "required": [
        "blockType",
        "direction"
      ],
      "type": "object"
    },
    "VisualBlockDescriptions.EditorConstant": {
      "additionalProperties": false,
      "description": "Displays a constant value that does not allow any user interaction.",
      "properties": {
        "blockType": {
          "enum": [
            "constant"
          ],
          "type": "string"
        },
        "marginLeft": {
          "type": "string"
        },
        "text": {
          "type": "string"
        }
      },
      "required": [
        "blockType",
        "text"
      ],
      "type": "object"
    },
    "VisualBlockDescriptions.EditorDropTarget": {
      "additionalProperties": false,
      "description": "Describes a \"block\" that only acts as a hole to drop things at.\nIt is not necesarily visible in every state and it is not draggable.",
      "properties": {
        "blockType": {
          "enum": [
            "dropTarget"
          ],
          "type": "string"
        },
        "children": {
          "items": {
            "$ref": "#/definitions/VisualBlockDescriptions.ConcreteBlock"
          },
          "type": "array"
        },
        "direction": {
          "enum": [
            "horizontal",
            "vertical"
          ],
          "type": "string"
        },
        "dropTarget": {
          "$ref": "#/definitions/VisualBlockDescriptions.DropTargetProperties"
        },
        "marginLeft": {
          "type": "string"
        },
        "visibility": {
          "items": [
            {
              "enum": [
                "ifAnyDrag",
                "ifLegalDrag",
                "ifEmpty",
                "always"
              ],
              "type": "string"
            }
          ],
          "minItems": 1,
          "type": "array"
        }
      },
      "required": [
        "blockType",
        "direction",
        "visibility"
      ],
      "type": "object"
    },
    "VisualBlockDescriptions.EditorInterpolated": {
      "additionalProperties": false,
      "description": "Displays a dynamic value that depends on some property of the node but\ndoes not allow to edit the property.",
      "properties": {
        "blockType": {
          "enum": [
            "interpolated"
          ],
          "type": "string"
        },
        "marginLeft": {
          "type": "string"
        },
        "property": {
          "type": "string"
        }
      },
      "required": [
        "blockType",
        "property"
      ],
      "type": "object"
    },
    "VisualBlockDescriptions.EditorIterator": {
      "additionalProperties": false,
      "description": "Allows to iterate over all blocks in a certain category.",
      "properties": {
        "between": {
          "items": {
            "$ref": "#/definitions/VisualBlockDescriptions.ConcreteBlock"
          },
          "type": "array"
        },
        "blockType": {
          "enum": [
            "iterator"
          ],
          "type": "string"
        },
        "childGroupName": {
          "type": "string"
        },
        "direction": {
          "enum": [
            "horizontal",
            "vertical"
          ],
          "type": "string"
        },
        "marginLeft": {
          "type": "string"
        }
      },
      "required": [
        "blockType",
        "childGroupName",
        "direction"
      ],
      "type": "object"
    }
  }
}