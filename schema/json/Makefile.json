##################################
# Setting up shared paths
##################################

# Full path of typescript-json-schema
TYPESCRIPT_JSON_SCHEMA_BIN = ./node_modules/.bin/ts-json-schema-generator

# Names of the schema files to generate
JSON_SCHEMA_FILES = ProjectDescription.json ProjectUpdateDescription.json ProjectCreationDescription.json ProjectListDescription.json AlterSchemaRequestDescription.json TableDescription.json BlockLanguageDocument.json BlockLanguageDescription.json NodeDescription.json CodeResourceDescription.json ProjectSourceDescription.json

##################################
# Not so nice: Repeated rules
##################################

define CONVERT_COMMAND
	@echo "Creating $(notdir $(basename $@)).json"
	$(TYPESCRIPT_JSON_SCHEMA_BIN) --path $^ --type $(notdir $(basename $@)) > "$@.tmp"
	mv "$@.tmp" "$@"
endef

ProjectDescription.json : $(SRC_PATH)/shared/project.description.ts
	$(CONVERT_COMMAND)

ProjectUpdateDescription.json : $(SRC_PATH)/shared/project.description.ts
	$(CONVERT_COMMAND)

ProjectCreationDescription.json : $(SRC_PATH)/shared/project.description.ts
	$(CONVERT_COMMAND)

ProjectListDescription.json : $(SRC_PATH)/shared/project.description.ts
	$(CONVERT_COMMAND)

ProjectSourceDescription.json : $(SRC_PATH)/shared/project.description.ts
	$(CONVERT_COMMAND)

AlterSchemaRequestDescription.json : $(SRC_PATH)/shared/schema/table-commands.description.ts
	$(CONVERT_COMMAND)

TableDescription.json : $(SRC_PATH)/shared/schema/schema.description.ts
	$(CONVERT_COMMAND)

BlockLanguageDescription.json : $(SRC_PATH)/shared/block/block-language.description.ts
	$(CONVERT_COMMAND)

BlockLanguageDocument.json : $(SRC_PATH)/shared/block/block-language.description.ts
	$(CONVERT_COMMAND)

NodeDescription.json : $(SRC_PATH)/shared/syntaxtree/syntaxtree.description.ts
	$(CONVERT_COMMAND)

CodeResourceDescription.json : $(SRC_PATH)/shared/syntaxtree/coderesource.description.ts
	$(CONVERT_COMMAND)



